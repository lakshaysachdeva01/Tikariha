<%- include('header'), {seoDetails} %>
<div id="smooth-wrapper">
    <div id="smooth-content">
        <main>
    <!--======  Start Page Hero Section  ======-->
    <section class="page-hero bg_cover p-r z-1" data-src="/assets/images/innerpage/bg/page-bg.jpg ">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <!--=== Page Content ===-->
                    <div class="page-content text-center">
                        <h1>Jobs</h1>
                        <ul>
                            <li><a href="/">Home</a></li>
                            <li>jobs</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

<section id="news" class="container col-12 news-section-two" style="padding: 100px 0;">
    <div class="auto-container">
        <div class="row">
            <% if (jobs && jobs.length > 0) { %>
                <% jobs.forEach((job, index) => { %>
                <!-- News Block -->
                <div class="news-block-two col-lg-4 col-sm-6 wow fadeInUp">
                    <div class="inner-box wow fadeInLeft">
                        <div class="content-box">
                            <!-- Fix 1: Job category display - use job type -->
                            <p class="job-category" style="font-size: 12px; color: #A1a1a1; margin: 0 0 10px 0; font-weight: 400; text-transform: uppercase; font-family: 'Barlow Condensed', sans-serif;">
                                <%= job.type ? job.type.replace(/_/g, ' ') : 'General' %>
                            </p>
                            
                            <h4 class="title" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; min-height: 2.6em; margin-bottom: 15px;">
                                <a href="/job/<%= job._id %>"><%= job.jobTitle || 'Job Title' %></a>
                            </h4>
                            
                            <!-- Fix 2: Safe description display with fallback -->
                            <div class="desc" style="
    font-family: 'Barlow', sans-serif; 
    display: -webkit-box; 
    -webkit-line-clamp: 3; 
    -webkit-box-orient: vertical; 
    overflow: hidden; 
    text-overflow: ellipsis; 
    margin-bottom: 25px; 
    font-size: 14px; 
    color: #666666;
    line-height: 1.6;
">
    <% if (job.jobDescription && job.jobDescription[0] && job.jobDescription[0].description) { 
        // Extract text from HTML for preview
        let desc = job.jobDescription[0].description;
        // Remove all HTML tags for preview
        desc = desc.replace(/<[^>]*>/g, ' ');
        // Trim and get first 150 characters
        desc = desc.replace(/\s+/g, ' ').trim();
        desc = desc.substring(0, 150);
    %>
        <%= desc %>...
    <% } else { %>
        No description available.
    <% } %>
</div>
                            
                            <div class="btn-box">
                                <a style="padding: 12px 0;" href="/job/<%= job._id %>">
                                    Read More
                                    <i class="fa-solid fa-arrow-right" style="margin-left: 10px; font-size:16px; color: #363636;"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <% }) %>
            <% } else { %>
            <!-- Optional: Add no jobs message if you want -->
            <div class="col-12 text-center">
                <p>No job openings available at the moment.</p>
            </div>
            <% } %>
        </div>
    </div>
</section>

<style>
    .news-section-two .news-block-two {
        margin-bottom: 30px;
    }
    
    .news-section-two .inner-box {
        background: #fff;
        border-radius: 8px;
        padding: 30px;
        height: 100%;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        border: 1px solid #f0f0f0;
    }
    
    @media (max-width: 768px) {
        .news-section-two {
            padding: 60px 0 !important;
        }
        
        .news-section-two .inner-box {
            padding: 20px;
        }
    }
</style>


</main>
<%- include('footer') %>
    </div>
    </div>
    